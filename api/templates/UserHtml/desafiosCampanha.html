{% extends "base.html" %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'api/css/UserCss/desafiosCampanha.css' %}">
<link rel="stylesheet" href="{% static 'api/components/menu/menu_colaborador/menu_colaborador.css' %}">

<div class="body-desafiosCampanha">
    {% include 'components/user/menuUser.html' %}

    <div class="central">
        <div class="central1">
            <div class="listaDesafios">

                <a href='/CampanhaAtivas/' class="voltarBotao">
                    <button class="voltar">
                        <img src="{% static 'api/img/flechaEsquerda.png' %}" alt="">
                        <h2>Voltar</h2>
                    </button>
                </a>

                <div class="titulo-desafiosCampanha">
                    <img src="{% static 'api/img/Vector.png' %}" alt="" class="vector">
                    <div class="textDecoratinDesafios">Desafios de campanha</div>
                </div>

                <div class="line"></div>

                <div class="cabecalhoMissoes">
                    <div class="centralizar">
                        <h3>Nome</h3>
                        <img src="{% static 'api/img/sort.png' %}" alt="" class="sort">
                    </div>
                    <h3 class="cabecalhoMissoesRecompensa">Recompensa $</h3>
                </div>

                <div class="desafios">
                    {% for i in desafios %}
                        <div class="desafiosFlex toggle-btn" data-id="{{ i.id }}">
                            <div class="alvoCampanha">
                                <img src="{% static 'api/img/alvoCampanha.png' %}" class="alvo">
                                <div class="texto-card">{{ i.nome }}</div>
                            </div>
                            <span class="laranja">DG$<span class="azul">{{ i.valor }}</span></span>
                        </div>
                
                        <div class="descricao-cascata" id="descricao-{{ i.id }}">
                            <p><strong>Descrição:</strong> {{ i.descricao }}</p>
                            <div class="datas-campanhas">
                                <p><strong>Fim:</strong> {{ i.dataFim|date:"d/m/Y" }}</p>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="pagination">
                    {% if desafios.has_previous %}
                        <a href="?desafio_page={{ desafios.previous_page_number }}">
                            <i class="fa fa-arrow-left" aria-hidden="true"></i>
                        </a>
                    {% endif %}
                
                    <span>Página {{ desafios.number }} de {{ desafios.paginator.num_pages }}</span>
                
                    {% if desafios.has_next %}
                        <a href="?desafio_page={{ desafios.next_page_number }}">
                            <i class="fa fa-arrow-right" aria-hidden="true"> </i>
                        </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    document.querySelectorAll(".desafiosFlex").forEach((card) => {
        card.addEventListener("click", function () {
            const id = card.getAttribute("data-id");
            const descricao = document.getElementById("descricao-" + id);

            // Fecha todas as outras descrições abertas
            document.querySelectorAll(".descricao-cascata.open").forEach(el => {
                if (el !== descricao) {
                    el.classList.remove("open");
                }
            });

            // Alterna a descrição do item clicado
            descricao.classList.toggle("open");
        });
    });
</script>
{% endblock %}
